<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="asset.css" />
    <title>Document</title>
  </head>
  <body>
    <main>
      <div>
        <button class="button button_item1" id="myButton">
          Джин-Клубника-Базилик
        </button>
        <button class="button button_item1" id="myButton2">
          Арбуз-Базилик
        </button>
        <button class="button button_item1" id="myButton3">
          Ром на груше - тархун
        </button>
        <button class="button button_item1" id="myButton4">
          Мокровь-Апльсин-Грейфрут
        </button>
        <button class="button button_item1" id="myButton5">Ром-Банан</button>
        <button class="button button_item1" id="myButton6">
          Алоэ-Джин-Красный бизилик
        </button>
      </div>
      <div>
        <button class="button button_item1" id="myButton7">Кислый</button>
        <button class="button button_item1" id="myButton8">Сладкий</button>
        <button class="button button_item1" id="myButton9">
          Кисло-сладкий
        </button>
        <button class="button button_item1" id="myButton10">Горький</button>
        <button class="button button_item1" id="myButton11">Соленый</button>
      </div>
      <div>
        <button class="button button_item1" id="myButton12">Крепкий</button>
        <button class="button button_item1" id="myButton13">Не крепкий</button>
      </div>

      <form id="dataForm">
        <label for="data">Собранные данные:</label>
        <input class="form" type="text" id="data" name="data" readonly />

        <button id="resetButton">Сброс</button>
        <button id="submitButton">Отправить</button>
      </form>
      <div id="resultMessage"></div>
      <script>
        function toggleTextAndBackground(button, text1, text2) {
          var isAlternate = false; // Флаг для отслеживания текущего состояния

          return function () {
            if (isAlternate) {
              // Если флаг установлен, возвращаем исходный текст и фон
              button.textContent = text1;
              button.style.backgroundColor = "";
            } else {
              // В противном случае, устанавливаем альтернативный текст и фон
              button.textContent = text2;
              button.style.backgroundColor = "#00ff00"; // Зеленый цвет фона
            }
            // Инвертируем флаг
            isAlternate = !isAlternate;
          };
        }
        //кнопки 1 ряд
        var button = document.getElementById("myButton");
        button.addEventListener(
          "click",
          toggleTextAndBackground(
            button,
            "Джин-Клубника-Базилик",
            "Заявка принята!"
          )
        );

        var button1 = document.getElementById("myButton2");
        button1.addEventListener(
          "click",
          toggleTextAndBackground(button1, "Арбуз-Базилик", "Заявка принята!")
        );

        var button2 = document.getElementById("myButton3");
        button2.addEventListener(
          "click",
          toggleTextAndBackground(
            button2,
            "Ром на груше - тархун",
            "Заявка принята!"
          )
        );

        var button3 = document.getElementById("myButton4");
        button3.addEventListener(
          "click",
          toggleTextAndBackground(
            button3,
            " Мокровь-Апльсин-Грейфрут",
            "Заявка принята!"
          )
        );

        var button4 = document.getElementById("myButton5");
        button4.addEventListener(
          "click",
          toggleTextAndBackground(button4, "Ром-Банан", "Заявка принята!")
        );

        var button5 = document.getElementById("myButton6");
        button5.addEventListener(
          "click",
          toggleTextAndBackground(
            button5,
            "Алоэ-Джин-Красный бизилик",
            "Заявка принята!"
          )
        );
        //кнопки 2 ряд
        var button6 = document.getElementById("myButton7");
        button6.addEventListener(
          "click",
          toggleTextAndBackground(button6, "Кислый", "Заявка принята!")
        );

        var button7 = document.getElementById("myButton8");
        button7.addEventListener(
          "click",
          toggleTextAndBackground(button7, "Сладкий", "Заявка принята!")
        );

        var button8 = document.getElementById("myButton9");
        button8.addEventListener(
          "click",
          toggleTextAndBackground(button8, "Кисло-Сладкий", "Заявка принята!")
        );

        var button9 = document.getElementById("myButton10");
        button9.addEventListener(
          "click",
          toggleTextAndBackground(button9, "Горький", "Заявка принята!")
        );

        var button10 = document.getElementById("myButton11");
        button10.addEventListener(
          "click",
          toggleTextAndBackground(button10, "Соленый", "Заявка принята!")
        );
        //3ряд кнопки
        var button11 = document.getElementById("myButton12");
        button11.addEventListener(
          "click",
          toggleTextAndBackground(button11, "Крепкий", "Заявка принята!")
        );

        var button12 = document.getElementById("myButton13");
        button12.addEventListener(
          "click",
          toggleTextAndBackground(button12, "Не крепкий", "Заявка принята!")
        );

        //форма

        var collectedData = [];

        function handleButtonClick(button) {
          var buttonText = button.textContent;
          var index = collectedData.indexOf(buttonText);

          if (index !== -1) {
            collectedData.splice(index, 1);
          } else {
            collectedData.push(buttonText);
          }

          var dataField = document.getElementById("data");
          dataField.value = collectedData.join(", ");
        }

        var buttons = document.querySelectorAll(".button");
        buttons.forEach(function (button) {
          button.addEventListener("click", function () {
            handleButtonClick(button);
          });
        });

        var resetButton = document.getElementById("resetButton");
        resetButton.addEventListener("click", function () {
          collectedData = [];
          var dataField = document.getElementById("data");
          dataField.value = "";
        });

        // Скрипт отправки данных на Google Документ
        var googleScriptUrl =
          "https://script.google.com/macros/s/your-script-id/exec";

        var submitButton = document.getElementById("submitButton");
        var resultMessage = document.getElementById("resultMessage");

        submitButton.addEventListener("click", function () {
          var confirmation = confirm(
            "Вы уверены, что хотите отправить данные?"
          );

          if (confirmation) {
            // Если пользователь нажал "ОК" в окне подтверждения
            var xhr = new XMLHttpRequest();
            xhr.open("POST", googleScriptUrl, true);
            xhr.setRequestHeader(
              "Content-Type",
              "application/x-www-form-urlencoded"
            );

            xhr.onreadystatechange = function () {
              if (xhr.readyState == 4 && xhr.status == 200) {
                resultMessage.textContent = "Данные успешно отправлены.";
              } else if (xhr.readyState == 4 && xhr.status != 200) {
                resultMessage.textContent =
                  "Произошла ошибка при отправке данных.";
              }
            };

            var data = "data=" + encodeURIComponent(collectedData.join(", "));
            xhr.send(data);
          } else {
            // Если пользователь нажал "Отмена" в окне подтверждения
            resultMessage.textContent = "Отправка данных отменена.";
          }
        });
      </script>
    </main>
  </body>
</html>
